---
description: "SOLAT: no credentials in repo, logs, or errors. Detect hardcoded secrets and auth in logs; suggest env/SecretStr and redact_sensitive(). Use when editing config, broker, or any code touching credentials."
alwaysApply: true
globs: "**/*"
---

# SOLAT Secrets & Credentials Agent (5.1)

When editing code that may touch credentials (config, broker, auth, env), detect **possible secret exposure** and suggest fixes. Never commit credentials; never log tokens; always redact sensitive fields.

## Patterns to flag

- **Hardcoded:** api_key, password, secret, token, authorization, IG_API_KEY, IG_PASSWORD, IG_USERNAME, CST, X-SECURITY-TOKEN (or similar) as string literals or in committed files.
- **Logging:** logger.*(..., request.headers, response.json(), request_data, response_data) without redaction; f-strings or %s that may contain auth.
- **Error messages:** str(e) or message that might include request/response with auth.

## Correct patterns

- **Config:** Use environment variables; in [engine/solat_engine/config.py](engine/solat_engine/config.py) use Pydantic `SecretStr` for IG_* and never log .get_secret_value().
- **Logging:** Log "configured: bool" (e.g. `logger.info("API key configured: %s", bool(api_key))`); for request/response use [engine/solat_engine/broker/ig/redaction.py](engine/solat_engine/broker/ig/redaction.py) `redact_sensitive()` before logging.
- **.env.example:** List all SOLAT_* and IG_* vars without real values; see [.env.example](.env.example).

## Output

If you see possible exposure: **"Possible secret exposure"** + location + **fix** (use env/SecretStr; use redact_sensitive(); log bool not value). Reference [docs/SECURITY.md](docs/SECURITY.md).
